[
  {
    "database": "SalesDB",
    "schema": "dbo",
    "name": "GetCustomerOrders",
    "objectId": 1001,
    "definition": "CREATE PROCEDURE [dbo].[GetCustomerOrders]\n    @CustomerId INT,\n    @StartDate DATE = NULL,\n    @EndDate DATE = NULL\nAS\nBEGIN\n    SELECT \n        o.OrderId,\n        o.OrderDate,\n        o.TotalAmount,\n        c.CustomerName,\n        c.Email\n    FROM Orders o\n    INNER JOIN Customers c ON o.CustomerId = c.CustomerId\n    WHERE o.CustomerId = @CustomerId\n        AND (@StartDate IS NULL OR o.OrderDate >= @StartDate)\n        AND (@EndDate IS NULL OR o.OrderDate <= @EndDate)\n    ORDER BY o.OrderDate DESC\nEND",
    "description": "Retrieves all orders for a specific customer with optional date filtering. Used in customer portal and admin dashboard.",
    "projectReferences": ["CustomerPortal", "AdminDashboard"],
    "tablesUsed": ["Orders", "Customers"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-06-15T08:30:00.000Z",
    "modifiedDate": "2026-01-20T14:22:00.000Z"
  },
  {
    "database": "SalesDB",
    "schema": "dbo",
    "name": "CreateOrder",
    "objectId": 1002,
    "definition": "CREATE PROCEDURE [dbo].[CreateOrder]\n    @CustomerId INT,\n    @OrderDate DATE,\n    @TotalAmount DECIMAL(10,2),\n    @OrderId INT OUTPUT\nAS\nBEGIN\n    BEGIN TRANSACTION\n    \n    INSERT INTO Orders (CustomerId, OrderDate, TotalAmount, Status)\n    VALUES (@CustomerId, @OrderDate, @TotalAmount, 'Pending')\n    \n    SET @OrderId = SCOPE_IDENTITY()\n    \n    -- Update customer statistics\n    UPDATE Customers\n    SET TotalOrders = TotalOrders + 1,\n        LastOrderDate = @OrderDate\n    WHERE CustomerId = @CustomerId\n    \n    COMMIT TRANSACTION\n    \n    RETURN @OrderId\nEND",
    "description": "Creates a new order and updates customer statistics. Includes transaction handling for data consistency.",
    "projectReferences": ["E-Commerce", "OrderManagement"],
    "tablesUsed": ["Orders", "Customers"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-05-10T09:15:00.000Z",
    "modifiedDate": "2025-12-05T16:45:00.000Z"
  },
  {
    "database": "SalesDB",
    "schema": "sales",
    "name": "GenerateMonthlyReport",
    "objectId": 1003,
    "definition": "CREATE PROCEDURE [sales].[GenerateMonthlyReport]\n    @Year INT,\n    @Month INT\nAS\nBEGIN\n    SELECT \n        DATEPART(DAY, o.OrderDate) AS Day,\n        COUNT(*) AS TotalOrders,\n        SUM(o.TotalAmount) AS Revenue,\n        AVG(o.TotalAmount) AS AvgOrderValue,\n        COUNT(DISTINCT o.CustomerId) AS UniqueCustomers\n    FROM Orders o\n    WHERE YEAR(o.OrderDate) = @Year\n        AND MONTH(o.OrderDate) = @Month\n    GROUP BY DATEPART(DAY, o.OrderDate)\n    ORDER BY Day\nEND",
    "description": "Generates daily aggregated sales data for a specific month. Used in reporting dashboard and analytics.",
    "projectReferences": ["Reporting", "Analytics", "BusinessIntelligence"],
    "tablesUsed": ["Orders"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-07-22T11:00:00.000Z",
    "modifiedDate": "2026-01-15T10:30:00.000Z"
  },
  {
    "database": "InventoryDB",
    "schema": "dbo",
    "name": "UpdateProductStock",
    "objectId": 2001,
    "definition": "CREATE PROCEDURE [dbo].[UpdateProductStock]\n    @ProductId INT,\n    @Quantity INT,\n    @Operation VARCHAR(10) -- 'ADD' or 'SUBTRACT'\nAS\nBEGIN\n    DECLARE @CurrentStock INT\n    \n    SELECT @CurrentStock = Stock\n    FROM Products\n    WHERE ProductId = @ProductId\n    \n    IF @Operation = 'ADD'\n        UPDATE Products SET Stock = Stock + @Quantity WHERE ProductId = @ProductId\n    ELSE IF @Operation = 'SUBTRACT'\n    BEGIN\n        IF @CurrentStock >= @Quantity\n            UPDATE Products SET Stock = Stock - @Quantity WHERE ProductId = @ProductId\n        ELSE\n            RAISERROR('Insufficient stock', 16, 1)\n    END\n    \n    -- Log stock movement\n    INSERT INTO StockMovements (ProductId, Quantity, Operation, MovementDate)\n    VALUES (@ProductId, @Quantity, @Operation, GETDATE())\nEND",
    "description": "Updates product stock levels with validation and movement logging. Prevents negative stock.",
    "projectReferences": ["InventoryManagement", "Warehouse"],
    "tablesUsed": ["Products", "StockMovements"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-04-18T13:20:00.000Z",
    "modifiedDate": "2025-11-30T09:15:00.000Z"
  },
  {
    "database": "InventoryDB",
    "schema": "dbo",
    "name": "GetLowStockProducts",
    "objectId": 2002,
    "definition": "CREATE PROCEDURE [dbo].[GetLowStockProducts]\n    @Threshold INT = 10\nAS\nBEGIN\n    SELECT \n        p.ProductId,\n        p.ProductName,\n        p.Stock,\n        p.MinimumStock,\n        c.CategoryName,\n        s.SupplierName,\n        s.Email AS SupplierEmail\n    FROM Products p\n    INNER JOIN Categories c ON p.CategoryId = c.CategoryId\n    LEFT JOIN Suppliers s ON p.SupplierId = s.SupplierId\n    WHERE p.Stock <= @Threshold\n        OR p.Stock <= p.MinimumStock\n    ORDER BY p.Stock ASC\nEND",
    "description": "Identifies products with low stock levels for reordering. Includes supplier contact information.",
    "projectReferences": ["InventoryManagement", "PurchaseOrders"],
    "tablesUsed": ["Products", "Categories", "Suppliers"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-06-01T10:45:00.000Z",
    "modifiedDate": "2025-12-10T14:20:00.000Z"
  },
  {
    "database": "HRDB",
    "schema": "dbo",
    "name": "CalculateEmployeeSalary",
    "objectId": 3001,
    "definition": "CREATE PROCEDURE [dbo].[CalculateEmployeeSalary]\n    @EmployeeId INT,\n    @Month INT,\n    @Year INT\nAS\nBEGIN\n    DECLARE @BaseSalary DECIMAL(10,2)\n    DECLARE @Bonuses DECIMAL(10,2)\n    DECLARE @Deductions DECIMAL(10,2)\n    \n    SELECT @BaseSalary = BaseSalary\n    FROM Employees\n    WHERE EmployeeId = @EmployeeId\n    \n    SELECT @Bonuses = ISNULL(SUM(Amount), 0)\n    FROM Bonuses\n    WHERE EmployeeId = @EmployeeId\n        AND MONTH(BonusDate) = @Month\n        AND YEAR(BonusDate) = @Year\n    \n    SELECT @Deductions = ISNULL(SUM(Amount), 0)\n    FROM Deductions\n    WHERE EmployeeId = @EmployeeId\n        AND MONTH(DeductionDate) = @Month\n        AND YEAR(DeductionDate) = @Year\n    \n    SELECT \n        @BaseSalary AS BaseSalary,\n        @Bonuses AS Bonuses,\n        @Deductions AS Deductions,\n        (@BaseSalary + @Bonuses - @Deductions) AS NetSalary\nEND",
    "description": "Calculates employee net salary including bonuses and deductions for payroll processing.",
    "projectReferences": ["Payroll", "HRManagement"],
    "tablesUsed": ["Employees", "Bonuses", "Deductions"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-03-12T08:00:00.000Z",
    "modifiedDate": "2025-10-25T11:30:00.000Z"
  },
  {
    "database": "HRDB",
    "schema": "hr",
    "name": "GetEmployeeAttendance",
    "objectId": 3002,
    "definition": "CREATE PROCEDURE [hr].[GetEmployeeAttendance]\n    @EmployeeId INT,\n    @StartDate DATE,\n    @EndDate DATE\nAS\nBEGIN\n    SELECT \n        a.AttendanceDate,\n        a.CheckInTime,\n        a.CheckOutTime,\n        DATEDIFF(HOUR, a.CheckInTime, a.CheckOutTime) AS HoursWorked,\n        a.Status,\n        e.EmployeeName,\n        d.DepartmentName\n    FROM Attendance a\n    INNER JOIN Employees e ON a.EmployeeId = e.EmployeeId\n    INNER JOIN Departments d ON e.DepartmentId = d.DepartmentId\n    WHERE a.EmployeeId = @EmployeeId\n        AND a.AttendanceDate BETWEEN @StartDate AND @EndDate\n    ORDER BY a.AttendanceDate DESC\nEND",
    "description": "Retrieves employee attendance records with calculated work hours for a date range.",
    "projectReferences": ["TimeTracking", "HRManagement"],
    "tablesUsed": ["Attendance", "Employees", "Departments"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-05-20T09:30:00.000Z",
    "modifiedDate": "2026-01-10T15:00:00.000Z"
  },
  {
    "database": "SalesDB",
    "schema": "dbo",
    "name": "GetTopCustomers",
    "objectId": 1004,
    "definition": "CREATE PROCEDURE [dbo].[GetTopCustomers]\n    @TopN INT = 10,\n    @StartDate DATE = NULL,\n    @EndDate DATE = NULL\nAS\nBEGIN\n    SELECT TOP (@TopN)\n        c.CustomerId,\n        c.CustomerName,\n        c.Email,\n        COUNT(o.OrderId) AS TotalOrders,\n        SUM(o.TotalAmount) AS TotalRevenue,\n        AVG(o.TotalAmount) AS AvgOrderValue,\n        MAX(o.OrderDate) AS LastOrderDate\n    FROM Customers c\n    INNER JOIN Orders o ON c.CustomerId = o.CustomerId\n    WHERE (@StartDate IS NULL OR o.OrderDate >= @StartDate)\n        AND (@EndDate IS NULL OR o.OrderDate <= @EndDate)\n    GROUP BY c.CustomerId, c.CustomerName, c.Email\n    ORDER BY TotalRevenue DESC\nEND",
    "description": "Identifies top customers by revenue with optional date filtering. Used in CRM and marketing campaigns.",
    "projectReferences": ["CRM", "Marketing", "Analytics"],
    "tablesUsed": ["Customers", "Orders"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-08-05T12:15:00.000Z",
    "modifiedDate": "2026-01-18T10:45:00.000Z"
  },
  {
    "database": "InventoryDB",
    "schema": "warehouse",
    "name": "ProcessShipment",
    "objectId": 2003,
    "definition": "CREATE PROCEDURE [warehouse].[ProcessShipment]\n    @OrderId INT,\n    @ShipmentDate DATE,\n    @TrackingNumber VARCHAR(50)\nAS\nBEGIN\n    BEGIN TRANSACTION\n    \n    -- Create shipment record\n    INSERT INTO Shipments (OrderId, ShipmentDate, TrackingNumber, Status)\n    VALUES (@OrderId, @ShipmentDate, @TrackingNumber, 'In Transit')\n    \n    -- Update order status\n    UPDATE Orders\n    SET Status = 'Shipped',\n        ShippedDate = @ShipmentDate\n    WHERE OrderId = @OrderId\n    \n    -- Reduce stock for order items\n    UPDATE p\n    SET p.Stock = p.Stock - oi.Quantity\n    FROM Products p\n    INNER JOIN OrderItems oi ON p.ProductId = oi.ProductId\n    WHERE oi.OrderId = @OrderId\n    \n    COMMIT TRANSACTION\nEND",
    "description": "Processes order shipment, updates inventory, and creates tracking record. Includes transaction handling.",
    "projectReferences": ["Warehouse", "OrderFulfillment", "Logistics"],
    "tablesUsed": ["Shipments", "Orders", "Products", "OrderItems"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-07-10T14:00:00.000Z",
    "modifiedDate": "2025-12-20T09:30:00.000Z"
  },
  {
    "database": "SalesDB",
    "schema": "analytics",
    "name": "GetSalesTrends",
    "objectId": 1005,
    "definition": "CREATE PROCEDURE [analytics].[GetSalesTrends]\n    @Period VARCHAR(10) = 'MONTHLY' -- 'DAILY', 'WEEKLY', 'MONTHLY', 'YEARLY'\nAS\nBEGIN\n    IF @Period = 'DAILY'\n        SELECT \n            CAST(OrderDate AS DATE) AS Period,\n            COUNT(*) AS Orders,\n            SUM(TotalAmount) AS Revenue\n        FROM Orders\n        WHERE OrderDate >= DATEADD(DAY, -30, GETDATE())\n        GROUP BY CAST(OrderDate AS DATE)\n        ORDER BY Period\n    ELSE IF @Period = 'MONTHLY'\n        SELECT \n            FORMAT(OrderDate, 'yyyy-MM') AS Period,\n            COUNT(*) AS Orders,\n            SUM(TotalAmount) AS Revenue\n        FROM Orders\n        WHERE OrderDate >= DATEADD(MONTH, -12, GETDATE())\n        GROUP BY FORMAT(OrderDate, 'yyyy-MM')\n        ORDER BY Period\nEND",
    "description": "Analyzes sales trends over different time periods for business intelligence dashboards.",
    "projectReferences": ["BusinessIntelligence", "Analytics", "ExecutiveDashboard"],
    "tablesUsed": ["Orders"],
    "lastScanned": "2026-01-28T10:00:00.000Z",
    "createdDate": "2025-09-15T11:20:00.000Z",
    "modifiedDate": "2026-01-22T13:15:00.000Z"
  }
]
